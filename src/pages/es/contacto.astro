---
// src/pages/es/contacto.astro
import Layout from '../../layouts/Layout.astro';

const title = "Contacto | Globo Care Remodeling Florida";
const description = "¿Listo para transformar tu hogar? Contáctanos hoy mismo para solicitar tu estimado gratis en Sarasota, Bradenton, Tampa y alrededores.";

// Datos de contacto
const whatsappLink = "https://wa.me/19418961852";
const phoneLink = "tel:+19418961852";
const emailLink = "mailto:info@globocareremodeling.com";
---

<Layout title={title} description={description}>

  {/* --- HERO TÉCNICO MINIMALISTA (Nuevo Diseño Contacto) --- */}
  <section class="relative bg-neutral-deep text-white py-20 border-b border-white/5 overflow-hidden">
    
    {/* Fondo de Cuadrícula (Grid) */}
    <div class="absolute inset-0 opacity-5 pointer-events-none" 
         style="background-image: linear-gradient(to right, #ffffff 1px, transparent 1px), linear-gradient(to bottom, #ffffff 1px, transparent 1px); background-size: 50px 50px;">
    </div>
    
    {/* Luz Central Sutil */}
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[300px] bg-primary/5 blur-[100px] rounded-full pointer-events-none"></div>

    <div class="relative z-10 max-w-4xl mx-auto px-6 text-center">
      {/* Marco Decorativo */}
      <div class="border-l border-r border-primary/20 px-6 py-8 relative">
          
          {/* Esquinas */}
          <div class="absolute top-0 left-0 w-3 h-3 border-t border-l border-primary/50"></div>
          <div class="absolute top-0 right-0 w-3 h-3 border-t border-r border-primary/50"></div>
          <div class="absolute bottom-0 left-0 w-3 h-3 border-b border-l border-primary/50"></div>
          <div class="absolute bottom-0 right-0 w-3 h-3 border-b border-r border-primary/50"></div>

          <h1 class="font-heading text-3xl md:text-5xl lg:text-6xl font-bold tracking-tight mb-5 text-white leading-tight">
            Estamos listos para iniciar tu <br class="hidden md:block" />
            <span class="text-primary">próximo proyecto.</span>
          </h1>
          
          {/* Línea Separadora */}
          <div class="w-20 h-px bg-gradient-to-r from-transparent via-primary/60 to-transparent mx-auto mb-6 opacity-40"></div>

          <p class="text-lg md:text-xl text-gray-400 font-light max-w-2xl mx-auto leading-relaxed">
            Sin intermediarios ni esperas. Comunícate directamente con nosotros para agendar tu visita técnica o estimado gratuito.
          </p>
      </div>
    </div>
  </section>

  <section class="py-20 bg-gray-50">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- <div class="text-center mb-10">
        <h2 class="font-heading text-3xl md:text-4xl font-bold text-neutral-deep">Solicite un Estimado Detallado</h2>
        <p class="text-slate-600 mt-4 text-lg">Déjenos saber cómo podemos ayudarle. Complete el formulario y le responderemos a la brevedad.</p>
      </div> -->

      <form id="contact-form" class="bg-white rounded-3xl p-8 md:p-12 shadow-lg border border-gray-100 mb-20 relative overflow-hidden space-y-6">
        
        <div style="position: absolute; left: -9999px;" aria-hidden="true">
          <label for="confirm_email">No llenes esto si eres humano</label>
          <input type="text" name="confirm_email" id="confirm_email" tabindex="-1" autocomplete="off" />
        </div>
        <input type="hidden" name="submit_time" id="submit_time" value="" />

        <div class="relative z-10">
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <label for="name" class="block text-sm font-bold text-gray-700">Nombre Completo *</label>
                <input type="text" id="name" name="name" required class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" placeholder="Juan Pérez" />
              </div>
              <div class="space-y-2">
                <label for="phone" class="block text-sm font-bold text-gray-700">Teléfono</label>
                <input type="tel" id="phone" name="phone" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" placeholder="(941) 000-0000" />
              </div>
            </div>

            <div class="space-y-2 mt-6">
              <label for="email" class="block text-sm font-bold text-gray-700">Correo Electrónico *</label>
              <input type="email" id="email" name="email" required class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" placeholder="ejemplo@correo.com" />
            </div>

            <div class="grid md:grid-cols-3 gap-6 mt-6">
              <div class="space-y-2">
                <label for="customerType" class="block text-sm font-bold text-gray-700">Soy...</label>
                <select id="customerType" name="customerType" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all bg-white">
                  <option value="Propietario de Casa">Propietario de Casa</option>
                  <option value="Dueño de Negocio">Dueño de Negocio</option>
                  <option value="Contratista/Inmobiliaria">Contratista/Realtor</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>

              <div class="space-y-2">
                <label for="service" class="block text-sm font-bold text-gray-700">Interesado en...</label>
                <select id="service" name="service" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all bg-white">
                  <option value="Zócalos">Zócalos</option>       {/* Traducción de Baseboards */}
                  <option value="Puertas">Puertas</option>       {/* Traducción de Doors */}
                  <option value="Instalación de Pisos">Instalación de Pisos</option>
                  <option value="Demolición">Demolición</option>
                  <option value="Baños/Cocinas">Baños/Cocinas</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>

               <div class="space-y-2">
                <label for="timeline" class="block text-sm font-bold text-gray-700">¿Para cuándo?</label>
                <select id="timeline" name="timeline" class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all bg-white">
                  <option value="Lo antes posible">Lo antes posible</option>
                  <option value="En 1 mes">En 1 mes</option>
                  <option value="Solo cotizando">Solo cotizando</option>
                </select>
              </div>
            </div>

            <div class="space-y-2 mt-6 mb-8">
              <label for="message" class="block text-sm font-bold text-gray-700">Detalles del Proyecto *</label>
              <textarea id="message" name="message" rows="4" required class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" placeholder="Cuéntenos más sobre lo que necesita..."></textarea>
            </div>

            <button type="submit" id="submit-btn" class="w-full md:w-auto px-8 py-4 bg-primary hover:bg-primary-dark text-black font-bold rounded-full shadow-lg shadow-orange-200 transition-all transform hover:-translate-y-1">
              Enviar Solicitud
            </button>
            
            <p id="form-message" class="hidden text-center mt-4 font-bold"></p>
        </div>
      </form>

      <div class="bg-white rounded-3xl p-8 md:p-12 shadow-sm border border-gray-100 flex flex-col md:flex-row gap-12">
          
          <div class="md:w-1/2 flex flex-col justify-center">
              <div class="inline-flex items-center gap-2 text-primary font-bold mb-4">
                <span class="w-8 h-1 bg-primary rounded-full"></span>
                <span class="uppercase tracking-wider text-sm">Nuestra Área de Servicio</span>
              </div>
              <h2 class="font-heading text-3xl font-bold text-neutral-deep mb-6">Expertos Locales en Florida</h2>
              <p class="text-slate-600 mb-8 leading-relaxed text-lg">
                  Servimos orgullosamente a toda la región, incluyendo <strong>Sarasota, Bradenton, Tampa, Venice y North Port</strong>. 
                  Conocemos los estándares de calidad y estilo que su comunidad exige.
              </p>
              
              <div class="space-y-6">
                  <div class="flex items-start gap-4 text-slate-700 group">
                    <div class="p-3 bg-neutral-light rounded-full text-primary group-hover:bg-primary group-hover:text-white transition-colors">
                       <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
                    </div>
                    <div>
                      <span class="block text-xs font-bold text-gray-400 uppercase tracking-wide mb-1">Llámenos</span>
                      <a href={phoneLink} class="text-lg font-medium hover:text-primary transition-colors">(941) 896-1852</a>
                    </div>
                  </div>

                  <div class="flex items-start gap-4 text-slate-700 group">
                      <div class="p-3 bg-neutral-light rounded-full text-primary group-hover:bg-primary group-hover:text-white transition-colors">
                         <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                      </div>
                      <div>
                        <span class="block text-xs font-bold text-gray-400 uppercase tracking-wide mb-1">Email</span>
                        <a href={emailLink} class="text-lg font-medium hover:text-primary transition-colors">info@globocareremodeling.com</a>
                      </div>
                  </div>
                
                   
              </div>
          </div>

          <div class="md:w-1/2">
              <div class="rounded-2xl overflow-hidden shadow-lg h-80 md:h-full bg-gray-100 ring-4 ring-white">
                  <iframe src="https://maps.google.com/maps?q=Sarasota%2C+Bradenton%2C+Tampa%2C+Venice%2C+North+Port%2C+FL&t=&z=9&ie=UTF8&iwloc=&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
              </div>
          </div>

      </div>

    </div>
  </section>

  <script>
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const messageEl = document.getElementById('form-message');
    const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
    const submitTimeInput = document.getElementById('submit_time') as HTMLInputElement;

    const loadTime = Date.now();

    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (submitTimeInput) {
           submitTimeInput.value = loadTime.toString();
        }

        const originalBtnText = submitBtn.innerText;
        submitBtn.disabled = true;
        submitBtn.innerText = "Enviando...";
        submitBtn.classList.add('opacity-75');

        try {
          const formData = new FormData(form);
          const response = await fetch('/api/send-email', {
            method: 'POST',
            body: formData,
          });

          if (response.ok) {
            form.reset();
            if(messageEl) {
              messageEl.classList.remove('hidden', 'text-red-500');
              messageEl.classList.add('text-green-600');
              messageEl.innerText = "¡Mensaje enviado correctamente! Nos pondremos en contacto pronto.";
            }
          } else {
             if (response.status === 429) {
                 throw new Error("Envío demasiado rápido. Por favor verifica tus datos.");
             }
             throw new Error('Error en el envío');
          }
        } catch (error: any) {
           if(messageEl) {
              messageEl.classList.remove('hidden', 'text-green-600');
              messageEl.classList.add('text-red-500');
              messageEl.innerText = error.message || "Hubo un error al enviar el mensaje.";
           }
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerText = originalBtnText;
          submitBtn.classList.remove('opacity-75');
        }
      });
    }
  </script>

</Layout>